@{
    Layout = "~/Views/Shared/ConLayout.cshtml";
}
<script src="https://balkangraph.com/js/latest/OrgChart.js"></script>

<div id="maindiv" class="container">
    <ul class="breadcrumb">
        <li class="breadcrumb-item">
            <a href="/CH/index">首頁</a>
        </li>
        <li class="breadcrumb-item active">
            <a href="#">組織樹</a>
        </li>
    </ul>
    <section id="title">
        <div class="title-set">
            <h4 class="title">組織樹</h4>
        </div>
    </section>
    <section id="form">
        <div id="divTree" style="display:none" class="col-lg-12">
            <select style="padding: 10px;width: 100px;z-index:2;" id="selectTemplate" class="col-lg-2">
                <option>luba</option>
                <option>olivia</option>
                <option>derek</option>
                <option>diva</option>
                <option>mila</option>
                <option>polina</option>
                <option>mery</option>
                <option>rony</option>
                <option>belinda</option>
                <option>ula</option>
                <option>ana</option>
                <option>isla</option>
            </select>
            <div id="tree" class="col-lg-10"></div>
        </div>
    </section>
</div>
<script>
    //權限設定
    var conRole = readCookie('conRole');
    var conAccount = readCookie('conAccount');

    $(document).ready(function () {
        loadData();
    });

    function loadData() {
        var obj =
        {
            ConID: conAccount
        }
        $('#maindiv').jqLoading();
        $.getJSON("/ConInfo/GetConOrgTreeByConID", obj).done(function (data) {
            if (data.length == 0) {
                //alert('查無資料')
                sweetAlert("查無資料!", "", "warning");
                $('#maindiv').jqLoading("destroy");
                return;
            }
            $('#divTree').show();

            var nodes = new Array();
            for (var i = 0; i < data.length; i++) {

                //表示公司
                //if ($.trim(data[i].Parent_Con_ID) == '000')
                //    continue;

                //if (i > 0 || $.trim(data[i].Parent_Con_ID) == '000') {
                //    var arr = new Array();
                //    arr.push($.trim(data[i].Parent_Con_ID), $.trim(data[i].Con_ID));
                //    fromTo.push(arr);
                //}
                //nodes.push({ id: $.trim(data[i].Con_ID), title: $.trim(data[i].Con_ID), name: $.trim(data[i].ChiName) + "/" + data[i].Con_Hiera });
                nodes.push({ id: $.trim(data[i].Con_ID), pid: $.trim(data[i].Parent_Con_ID), UID: $.trim(data[i].Con_ID), NAME: $.trim(data[i].ChiName) + "/" + data[i].Con_Hiera });
            }

            var chart = new OrgChart(document.getElementById("tree"), {
                template: "polina",
                layout: OrgChart.mixed,
                nodeBinding: {
                    field_0: "NAME",
                    field_1: "UID",
                },
                nodes: nodes
            });
            document.getElementById("selectTemplate").addEventListener("change", function () {
                chart.config.template = this.value;
                chart.draw();
            });
            $('#maindiv').jqLoading("destroy");
        })
    }
</script>